@model List<TaskDistribution>
@{
    ViewData["Title"] = "Свободные сотрудники";
    var overallPercentageused = ViewData["Percent"].ToString() + "%";
    var countAll = ViewData["CountAll"];
    var countUsed = ViewData["CountUsed"];
    var countFree = ViewData["CountFree"];

}

<h1 class="text-center colortext">Свободные сотрудники</h1>

<hr />
<body class="body">
    <style>
        #chartdiv {
            width: 100%;
            height: 500px;
        }
    </style>

    <!-- Resources -->
    <script src="https://cdn.amcharts.com/lib/4/core.js"></script>
    <script src="https://cdn.amcharts.com/lib/4/charts.js"></script>
    <script src="https://cdn.amcharts.com/lib/4/themes/dark.js"></script>
    <script src="https://cdn.amcharts.com/lib/4/themes/dataviz.js"></script>
    <script src="https://cdn.amcharts.com/lib/4/themes/animated.js"></script>

    <!-- Chart code -->
    <script>
    am4core.ready(function () {

        // Themes begin
        am4core.useTheme(am4themes_dark);
        am4core.useTheme(am4themes_dataviz);
        am4core.useTheme(am4themes_animated);
        // Themes end

        var chart = am4core.create("chartdiv", am4charts.PieChart);
        chart.hiddenState.properties.opacity = 0; // this creates initial fade-in

        chart.data = [
            {
                country: "Занято",
                value: "@countUsed"
            },
            {
                country: "Свободно",
                value: "@countFree"
            }
        ];
        chart.radius = am4core.percent(70);
        chart.innerRadius = am4core.percent(40);
        chart.startAngle = 180;
        chart.endAngle = 360;

        var series = chart.series.push(new am4charts.PieSeries());
        series.dataFields.value = "value";
        series.dataFields.category = "country";

        series.slices.template.cornerRadius = 10;
        series.slices.template.innerCornerRadius = 7;
        series.slices.template.draggable = true;
        series.slices.template.inert = true;
        series.alignLabels = false;

        series.hiddenState.properties.startAngle = 90;
        series.hiddenState.properties.endAngle = 90;

        chart.legend = new am4charts.Legend();

    }); // end am4core.ready()
    </script>

    <!-- HTML -->
    <div id="chartdiv"></div>
</body>


<body class="body">

    <br />
    <br />
    <table class="table table-dark">
        <tbody>
            <tr>
                <th scope="row">Всего</th>
                <td>@countAll</td>
            </tr>
            <tr>
                <th scope="row">Свободно</th>
                <td>@countFree</td>
            </tr>
            <tr>
                <th scope="row">Занято</th>
                <td>@countUsed</td>
            </tr>
        </tbody>
    </table>
    <p class="text-center colortext">
        Занятые сотрудники
    </p>
    <table class="table table-dark"
    <tbody>
        <thead>
            <th class="colortext">Дата распределения</th>
            <th class="colortext">Значение распределения</th>
            <th class="colortext">Значение</th>
            <th class="colortext">Сотрудник</th>
        </thead>
        @foreach (var item in Model)
        {
            <tr>

                <td class="colortext">
                    @Html.DisplayFor(modelItem => item.StartedAt)
                </td>

                <td class="colortext">
                    @Html.DisplayFor(modelItem => item.PeriodValue)
                </td>

                <td class="colortext">
                    @Html.DisplayFor(modelItem => item.PeriodUnit)
                </td>

                <td class="colortext">
                    @Html.DisplayFor(modelItem => item.Plurality.View)
                </td>
            </tr>
        }
    </tbody>
 </table>
</body>
<div class="progress" style="background-color:lawngreen">
    <div id="progressbarused" class="progress-bar bg-danger" role="progressbar" style="width: 100%"   aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
</div>
<script type="text/javascript" language="javascript">
    $("#progressbarused").css("width","@overallPercentageused");
    $("#progressbarused").text("Занято @overallPercentageused");
</script>
